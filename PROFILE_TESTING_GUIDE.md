# プロフィール機能 手動テスト手順書

## 前提条件
- アプリケーションが起動している（`npm run dev`）
- テスト用ユーザーが登録済み
- ブラウザのデベロッパーツールを開いておく

## テストシナリオ

### 1. プロフィール表示の確認

#### 手順
1. ログインページ（`/auth/login`）からログイン
2. ダッシュボードに移動
3. プロフィールページ（`/profile`）にアクセス

#### チェックポイント
- ✅ ページタイトル「プロフィール設定」が表示される
- ✅ アバター（名前の頭文字）が表示される
- ✅ 名前フィールドに現在の名前が表示される
- ✅ 自己紹介フィールドが表示される（初期は空でも可）
- ✅ メールアドレスフィールドが無効化されて表示される
- ✅ ユーザーIDフィールドが無効化されて表示される
- ✅ メール認証状態が表示される
- ✅ 「編集」ボタンが表示される
- ✅ 「パスワード変更」ボタンが表示される

### 2. プロフィール編集機能

#### 手順1: 編集モードの確認
1. 「編集」ボタンをクリック
2. フィールドの状態を確認

#### チェックポイント
- ✅ 名前フィールドが編集可能になる
- ✅ 自己紹介フィールドが編集可能になる
- ✅ メールアドレスフィールドは無効のまま
- ✅ 「キャンセル」ボタンが表示される
- ✅ 「保存」ボタンが表示される

#### 手順2: プロフィール更新
1. 名前を「テストユーザー更新」に変更
2. 自己紹介を「これは更新されたテストです。」に変更
3. 「保存」ボタンをクリック

#### チェックポイント
- ✅ 保存中にローディング表示される
- ✅ 成功メッセージ「プロフィールを更新しました」が表示される
- ✅ フィールドが再び無効化される
- ✅ 更新された値が表示される

#### 手順3: キャンセル機能
1. 「編集」ボタンをクリック
2. 名前を「一時的な変更」に変更
3. 「キャンセル」ボタンをクリック

#### チェックポイント
- ✅ 変更がリセットされる
- ✅ フィールドが無効化される
- ✅ 元の値が表示される

### 3. 文字数制限のチェック

#### 手順1: 名前の文字数制限
1. 「編集」ボタンをクリック
2. 名前フィールドに51文字入力（例：「あ」を51個）
3. 「保存」ボタンをクリック

#### チェックポイント
- ✅ エラーメッセージ「名前は50文字以内で入力してください」が表示される
- ✅ 保存が実行されない

#### 手順2: 自己紹介の文字数制限
1. 自己紹介フィールドに201文字入力（例：「あ」を201個）
2. 「保存」ボタンをクリック

#### チェックポイント
- ✅ エラーメッセージ「自己紹介は200文字以内で入力してください」が表示される
- ✅ 保存が実行されない

#### 手順3: 有効な文字数での保存
1. 名前を50文字に修正
2. 自己紹介を200文字に修正
3. 「保存」ボタンをクリック

#### チェックポイント
- ✅ 正常に保存される
- ✅ 成功メッセージが表示される

### 4. パスワード変更機能

#### 手順1: ダイアログの表示
1. 「パスワード変更」ボタンをクリック

#### チェックポイント
- ✅ パスワード変更ダイアログが開く
- ✅ 「現在のパスワード」フィールドが表示される
- ✅ 「新しいパスワード」フィールドが表示される
- ✅ 「パスワード確認」フィールドが表示される
- ✅ 各フィールドに目のアイコン（表示切り替え）が表示される
- ✅ 「キャンセル」ボタンが表示される
- ✅ 「変更」ボタンが表示される

#### 手順2: パスワード表示切り替え
1. 現在のパスワードフィールドに「test123」と入力
2. 目のアイコンをクリック

#### チェックポイント
- ✅ パスワードが平文で表示される
- ✅ アイコンが変化する
- ✅ 再クリックで非表示に戻る

#### 手順3: パスワード変更（正常ケース）
1. 現在のパスワードに正しいパスワードを入力
2. 新しいパスワードに「newpassword123」を入力
3. パスワード確認に「newpassword123」を入力
4. 「変更」ボタンをクリック

#### チェックポイント
- ✅ 変更中にローディング表示される
- ✅ 成功メッセージ「パスワードを変更しました」が表示される
- ✅ ダイアログが閉じる
- ✅ フィールドがクリアされる

### 5. パスワード変更のエラーケース

#### 手順1: 間違った現在のパスワード
1. パスワード変更ダイアログを開く
2. 現在のパスワードに間違ったパスワードを入力
3. 新しいパスワードに「newpassword123」を入力
4. パスワード確認に「newpassword123」を入力
5. 「変更」ボタンをクリック

#### チェックポイント
- ✅ エラーメッセージ「現在のパスワードが正しくありません」が表示される

#### 手順2: パスワード確認の不一致
1. 現在のパスワードに正しいパスワードを入力
2. 新しいパスワードに「newpassword123」を入力
3. パスワード確認に「different123」を入力
4. 「変更」ボタンをクリック

#### チェックポイント
- ✅ エラーメッセージ「パスワードが一致しません」が表示される

#### 手順3: 短いパスワード
1. 現在のパスワードに正しいパスワードを入力
2. 新しいパスワードに「12345」を入力（6文字未満）
3. パスワード確認に「12345」を入力
4. 「変更」ボタンをクリック

#### チェックポイント
- ✅ エラーメッセージ「新しいパスワードは6文字以上で入力してください」が表示される

#### 手順4: 同じパスワード
1. 現在のパスワードに「samepassword」を入力
2. 新しいパスワードに「samepassword」を入力
3. パスワード確認に「samepassword」を入力
4. 「変更」ボタンをクリック

#### チェックポイント
- ✅ エラーメッセージ「新しいパスワードは現在のパスワードと異なる必要があります」が表示される

### 6. 認証チェック（未ログイン時）

#### 手順
1. ブラウザでログアウト
2. プロフィールページ（`/profile`）に直接アクセス

#### チェックポイント
- ✅ ログインページ（`/auth/login`）にリダイレクトされる
- ✅ プロフィールページにアクセスできない

### 7. エラー処理の確認

#### 手順1: ネットワークエラーのシミュレーション
1. デベロッパーツールのNetworkタブを開く
2. 「Offline」モードに設定
3. プロフィール編集を試行

#### チェックポイント
- ✅ 適切なエラーメッセージが表示される
- ✅ アプリケーションがクラッシュしない

#### 手順2: サーバーエラーのシミュレーション
1. プロフィール更新時にサーバーを停止
2. 保存を試行

#### チェックポイント
- ✅ エラーメッセージが表示される
- ✅ ローディング状態が適切に終了する

## テスト実行チェックリスト

### 基本機能
- [ ] プロフィール表示
- [ ] プロフィール編集
- [ ] プロフィール保存
- [ ] 編集キャンセル
- [ ] パスワード変更ダイアログ表示
- [ ] パスワード変更実行
- [ ] パスワード変更キャンセル

### バリデーション
- [ ] 名前文字数制限（50文字）
- [ ] 自己紹介文字数制限（200文字）
- [ ] パスワード最小文字数（6文字）
- [ ] パスワード確認一致チェック
- [ ] 現在のパスワード確認
- [ ] 新旧パスワード同一チェック

### セキュリティ
- [ ] 未認証アクセスの拒否
- [ ] メールアドレス変更の無効化
- [ ] パスワード表示/非表示切り替え

### UX
- [ ] ローディング状態の表示
- [ ] 成功メッセージの表示
- [ ] エラーメッセージの表示
- [ ] フォームのリセット
- [ ] レスポンシブデザイン

## 注意事項

1. **テスト環境の準備**
   - 本番環境では実行しない
   - テスト専用のユーザーアカウントを使用する

2. **データの確認**
   - 変更後はデータベースの内容も確認する
   - パスワードがハッシュ化されて保存されることを確認

3. **ブラウザ対応**
   - Chrome、Firefox、Safari、Edgeで動作確認する
   - モバイルブラウザでの表示も確認する

4. **パフォーマンス**
   - ネットワークタブでAPI呼び出しを確認する
   - 不要なリクエストが発生していないかチェックする